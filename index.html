<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gi·ªØ Chu·ªói Th√≥i Quen</title>
    <style>
        body { text-align: center; font-family: Arial, sans-serif; background: #222; color: white; }
        .hidden { display: none; }
        .button { padding: 10px 20px; margin: 5px; border: none; background: orange; cursor: pointer; }
        .fire-effect { position: absolute; font-size: 30px; animation: fall 1s linear infinite; }
        @keyframes fall { 0% { transform: translateY(0); } 100% { transform: translateY(100vh); } }
    </style>
</head>
<body>
    <h1>üî• GI·ªÆ CHU·ªñI TH√ìI QUEN üî•</h1>
    <button id="startButton" class="button">Gi·ªØ Chu·ªói</button>
    
    <div id="habitSelection" class="hidden">
        <h2>Ch·ªçn lo·∫°i chu·ªói:</h2>
        <button class="habit-type button" data-type="habit">Th√≥i Quen</button>
        <button class="habit-type button" data-type="love">Ng√†y Y√™u ‚ù§Ô∏è</button>
        <button class="habit-type button" data-type="study">H·ªçc T·∫≠p üìö</button>
        <button class="habit-type button" data-type="fitness">T·∫≠p Th·ªÉ D·ª•c üèãÔ∏è</button>
        <button class="habit-type button" data-type="creative">S√°ng T·∫°o üé®</button>
    </div>

    <div id="dateSelection" class="hidden">
        <h2>Nh·∫≠p th√¥ng tin:</h2>
        <input type="text" id="username" placeholder="T√™n c·ªßa b·∫°n"><br>
        <input type="date" id="startDate"><br>
        <div id="partnerSection" class="hidden">
            <input type="text" id="partnerName" placeholder="T√™n ng∆∞·ªùi y√™u">
        </div>
        <button id="saveData" class="button">Ghi danh</button>
    </div>

    <div id="resultContainer" class="hidden">
        <h2 id="resultText"></h2>
        <button id="leaderboardBtn" class="button">Xem B·∫£ng X·∫øp H·∫°ng</button>
        <button id="miniGameBtn" class="button">Mini-Game X2 Chu·ªói</button>
    </div>

    <div id="leaderboard" class="hidden">
        <h2>TOP 100 NG∆Ø·ªúI GI·ªÆ CHU·ªñI</h2>
        <ol id="leaderboardList"></ol>
    </div>

    <div id="miniGame" class="hidden">
        <h2 id="miniGameQuestion"></h2>
        <div id="miniGameChoices"></div>
    </div>

    <script>
        let selectedType = "";

        document.getElementById("startButton").addEventListener("click", () => {
            document.getElementById("habitSelection").classList.remove("hidden");
        });

        document.querySelectorAll(".habit-type").forEach(button => {
            button.addEventListener("click", function() {
                selectedType = this.dataset.type;
                document.getElementById("habitSelection").classList.add("hidden");
                document.getElementById("dateSelection").classList.remove("hidden");

                if (selectedType === "love") {
                    document.getElementById("partnerSection").classList.remove("hidden");
                } else {
                    document.getElementById("partnerSection").classList.add("hidden");
                }
            });
        });

        document.getElementById("saveData").addEventListener("click", function() {
            let username = document.getElementById("username").value.trim();
            let startDate = new Date(document.getElementById("startDate").value);
            let today = new Date();
            
            if (!username) {
                alert("Vui l√≤ng nh·∫≠p t√™n!");
                return;
            }
            
            if (localStorage.getItem(username)) {
                alert("T√™n n√†y ƒë√£ ƒë∆∞·ª£c s·ª≠ d·ª•ng!");
                return;
            }
            
            if (startDate > today) {
                alert("Kh√¥ng th·ªÉ ch·ªçn ng√†y trong t∆∞∆°ng lai!");
                return;
            }

            let streakDays = Math.ceil((today - startDate) / (1000 * 60 * 60 * 24));
            
            localStorage.setItem(username, JSON.stringify({
                days: streakDays,
                type: selectedType
            }));

            document.getElementById("resultText").innerText = `${username} ƒë√£ gi·ªØ chu·ªói ƒë∆∞·ª£c ${streakDays} ng√†y!`;
            document.getElementById("dateSelection").classList.add("hidden");
            document.getElementById("resultContainer").classList.remove("hidden");

            for (let i = 0; i < 20; i++) {
                createFireEffect();
            }
        });

        function createFireEffect() {
            let fire = document.createElement("div");
            fire.classList.add("fire-effect");
            fire.innerHTML = "üî•";
            fire.style.left = Math.random() * window.innerWidth + "px";
            fire.style.top = "0px";
            document.body.appendChild(fire);
            setTimeout(() => fire.remove(), 1000);
        }

        document.getElementById("leaderboardBtn").addEventListener("click", () => {
            document.getElementById("leaderboard").classList.remove("hidden");
            let leaderboardList = document.getElementById("leaderboardList");
            leaderboardList.innerHTML = "";

            let users = Object.keys(localStorage).map(user => ({
                name: user,
                days: JSON.parse(localStorage.getItem(user)).days
            })).sort((a, b) => b.days - a.days).slice(0, 100);

            users.forEach(user => {
                let li = document.createElement("li");
                li.textContent = `${user.name}: ${user.days} ng√†y`;
                leaderboardList.appendChild(li);
            });
        });

        document.getElementById("miniGameBtn").addEventListener("click", () => {
            document.getElementById("miniGame").classList.remove("hidden");

            let questions = [
                { question: "1 + 1 b·∫±ng m·∫•y?", choices: ["2", "3", "4"], correct: 0 },
                { question: "Th·ªß ƒë√¥ Vi·ªát Nam l√† g√¨?", choices: ["H√† N·ªôi", "S√†i G√≤n", "ƒê√† N·∫µng"], correct: 0 }
            ];

            let q = questions[Math.floor(Math.random() * questions.length)];
            document.getElementById("miniGameQuestion").innerText = q.question;
            document.getElementById("miniGameChoices").innerHTML = "";

            q.choices.forEach((choice, index) => {
                let btn = document.createElement("button");
                btn.innerText = choice;
                btn.onclick = () => alert(index === q.correct ? "‚úÖ X2 Chu·ªói!" : "‚ùå Sai r·ªìi!");
                document.getElementById("miniGameChoices").appendChild(btn);
            });
        });
    </script>
</body>
</html>
