<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Giá»¯ Chuá»—i ThÃ³i Quen</title>
    <style>
        body { text-align: center; font-family: Arial, sans-serif; background: #121212; color: white; }
        .hidden { display: none; }
        .button {
            padding: 12px 24px; 
            margin: 10px; 
            border: none; 
            border-radius: 10px; 
            font-size: 18px; 
            cursor: pointer; 
            transition: 0.3s;
        }
        .button:hover { opacity: 0.8; }
        .fire-effect { position: absolute; font-size: 30px; animation: fall 1s linear infinite; }
        @keyframes fall { 0% { transform: translateY(0); } 100% { transform: translateY(100vh); } }
        
        /* MÃ u sáº¯c cho tá»«ng loáº¡i chuá»—i */
        .habit { background: #ff9800; color: white; }
        .love { background: #e91e63; color: white; }
        .study { background: #3f51b5; color: white; }
        .fitness { background: #4caf50; color: white; }
        .creative { background: #9c27b0; color: white; }

    </style>
</head>
<body>
    <h1>ğŸ”¥ GIá»® CHUá»–I THÃ“I QUEN ğŸ”¥</h1>
    <button id="startButton" class="button habit">Giá»¯ Chuá»—i</button>

    <div id="habitSelection" class="hidden">
        <h2>Chá»n loáº¡i chuá»—i:</h2>
        <button class="habit-type button habit" data-type="habit">ThÃ³i Quen ğŸ› ï¸</button>
        <button class="habit-type button love" data-type="love">NgÃ y YÃªu â¤ï¸</button>
        <button class="habit-type button study" data-type="study">Há»c Táº­p ğŸ“š</button>
        <button class="habit-type button fitness" data-type="fitness">Táº­p Thá»ƒ Dá»¥c ğŸ‹ï¸</button>
        <button class="habit-type button creative" data-type="creative">SÃ¡ng Táº¡o ğŸ¨</button>
    </div>

    <div id="dateSelection" class="hidden">
        <h2>Nháº­p thÃ´ng tin:</h2>
        <input type="text" id="username" placeholder="TÃªn cá»§a báº¡n"><br>
        <input type="date" id="startDate"><br>
        <div id="partnerSection" class="hidden">
            <input type="text" id="partnerName" placeholder="TÃªn ngÆ°á»i yÃªu">
        </div>
        <button id="saveData" class="button habit">Ghi danh</button>
    </div>

    <div id="resultContainer" class="hidden">
        <h2 id="resultText"></h2>
        <button id="leaderboardBtn" class="button study">ğŸ“Š Báº£ng Xáº¿p Háº¡ng</button>
        <button id="miniGameBtn" class="button creative">ğŸ® Mini-Game X2</button>
    </div>

    <div id="leaderboard" class="hidden">
        <h2>ğŸ† TOP 100 NGÆ¯á»œI GIá»® CHUá»–I</h2>
        <ol id="leaderboardList"></ol>
    </div>

    <div id="miniGame" class="hidden">
        <h2 id="miniGameQuestion"></h2>
        <div id="miniGameChoices"></div>
    </div>

    <script>
        let selectedType = "";

        document.getElementById("startButton").addEventListener("click", () => {
            document.getElementById("habitSelection").classList.remove("hidden");
        });

        document.querySelectorAll(".habit-type").forEach(button => {
            button.addEventListener("click", function() {
                selectedType = this.dataset.type;
                document.getElementById("habitSelection").classList.add("hidden");
                document.getElementById("dateSelection").classList.remove("hidden");

                if (selectedType === "love") {
                    document.getElementById("partnerSection").classList.remove("hidden");
                } else {
                    document.getElementById("partnerSection").classList.add("hidden");
                }
            });
        });

        document.getElementById("saveData").addEventListener("click", function() {
            let username = document.getElementById("username").value.trim();
            let startDate = new Date(document.getElementById("startDate").value);
            let today = new Date();
            
            if (!username) {
                alert("Vui lÃ²ng nháº­p tÃªn!");
                return;
            }
            
            if (localStorage.getItem(username)) {
                alert("TÃªn nÃ y Ä‘Ã£ Ä‘Æ°á»£c sá»­ dá»¥ng!");
                return;
            }
            
            if (startDate > today) {
                alert("KhÃ´ng thá»ƒ chá»n ngÃ y trong tÆ°Æ¡ng lai!");
                return;
            }

            let streakDays = Math.ceil((today - startDate) / (1000 * 60 * 60 * 24));
            
            localStorage.setItem(username, JSON.stringify({
                days: streakDays,
                type: selectedType
            }));

            document.getElementById("resultText").innerText = `${username} Ä‘Ã£ giá»¯ chuá»—i Ä‘Æ°á»£c ${streakDays} ngÃ y!`;
            document.getElementById("dateSelection").classList.add("hidden");
            document.getElementById("resultContainer").classList.remove("hidden");

            for (let i = 0; i < 20; i++) {
                createFireEffect();
            }
        });

        function createFireEffect() {
            let fire = document.createElement("div");
            fire.classList.add("fire-effect");
            fire.innerHTML = "ğŸ”¥";
            fire.style.left = Math.random() * window.innerWidth + "px";
            fire.style.top = "0px";
            document.body.appendChild(fire);
            setTimeout(() => fire.remove(), 1000);
        }

        document.getElementById("leaderboardBtn").addEventListener("click", () => {
            document.getElementById("leaderboard").classList.remove("hidden");
            let leaderboardList = document.getElementById("leaderboardList");
            leaderboardList.innerHTML = "";

            let users = Object.keys(localStorage).map(user => ({
                name: user,
                days: JSON.parse(localStorage.getItem(user)).days
            })).sort((a, b) => b.days - a.days).slice(0, 100);

            users.forEach(user => {
                let li = document.createElement("li");
                li.textContent = `${user.name}: ${user.days} ngÃ y`;
                leaderboardList.appendChild(li);
            });
        });

        document.getElementById("miniGameBtn").addEventListener("click", () => {
            document.getElementById("miniGame").classList.remove("hidden");

            let questions = [
                { question: "Máº·t trá»i má»c hÆ°á»›ng nÃ o?", choices: ["ÄÃ´ng", "TÃ¢y", "Báº¯c", "Nam"], correct: 0 },
                { question: "Thá»§ Ä‘Ã´ cá»§a Nháº­t Báº£n lÃ ?", choices: ["Tokyo", "Seoul", "Báº¯c Kinh", "Bangkok"], correct: 0 },
                { question: "5 x 6 = ?", choices: ["30", "25", "35", "40"], correct: 0 }
            ];

            let q = questions[Math.floor(Math.random() * questions.length)];
            document.getElementById("miniGameQuestion").innerText = q.question;
            document.getElementById("miniGameChoices").innerHTML = "";

            q.choices.sort(() => Math.random() - 0.5).forEach((choice, index) => {
                let btn = document.createElement("button");
                btn.innerText = choice;
                btn.onclick = () => alert(index === q.correct ? "âœ… ÄÃºng! X2 Chuá»—i!" : "âŒ Sai rá»“i!");
                document.getElementById("miniGameChoices").appendChild(btn);
            });
        });
    </script>
</body>
</html>
